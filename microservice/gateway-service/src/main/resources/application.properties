spring.application.name=gateway-service
server.port=8888

# eureka
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/
eureka.instance.prefer-ip-address=true

# JWT Configuration for Token Validation
jwt.secret=${JWT_SECRET:myVeryLongSecretKeyForJwtTokenGenerationThatIsAtLeast512BitsLongForHS512Algorithm}
# discovery service from Eureka via lb:// service ids
spring.cloud.gateway.server.webflux.discovery.locator.enabled=true
spring.cloud.gateway.server.webflux.discovery.locator.lower-case-service-id=true

# Route: product-service (public access)
spring.cloud.gateway.server.webflux.routes[0].id=product-service-route
spring.cloud.gateway.server.webflux.routes[0].uri=lb://product-service
spring.cloud.gateway.server.webflux.routes[0].predicates[0]=Path=/api/products/**,/api/categories/**,/api/banners/**


# Route: order-service (requires authentication)
spring.cloud.gateway.server.webflux.routes[1].id=order-service-route
spring.cloud.gateway.server.webflux.routes[1].uri=lb://order-service
spring.cloud.gateway.server.webflux.routes[1].predicates[0]=Path=/api/cart/**,/api/orders/**,/api/payment/**
spring.cloud.gateway.server.webflux.routes[1].filters[0]=Jwt

# Route: customer-service auth endpoints (public access)
spring.cloud.gateway.server.webflux.routes[2].id=customer-auth-route
spring.cloud.gateway.server.webflux.routes[2].uri=lb://customer-service
spring.cloud.gateway.server.webflux.routes[2].predicates[0]=Path=/api/auth/**

# Route: customer-service protected endpoints
spring.cloud.gateway.server.webflux.routes[3].id=customer-service-route
spring.cloud.gateway.server.webflux.routes[3].uri=lb://customer-service
spring.cloud.gateway.server.webflux.routes[3].predicates[0]=Path=/api/customers/**
spring.cloud.gateway.server.webflux.routes[3].filters[0]=Jwt

# Route: media-service
spring.cloud.gateway.server.webflux.routes[4].id=media-service-route
spring.cloud.gateway.server.webflux.routes[4].uri=lb://media-service
spring.cloud.gateway.server.webflux.routes[4].predicates[0]=Path=/api/mediaservice/**
spring.cloud.gateway.server.webflux.routes[4].filters[0]=Jwt

# Route: search-service
spring.cloud.gateway.server.webflux.routes[5].id=search-service-route
spring.cloud.gateway.server.webflux.routes[5].uri=lb://search-service
spring.cloud.gateway.server.webflux.routes[5].predicates[0]=Path=/api/search/**

# Default filters
spring.cloud.gateway.server.webflux.default-filters[0]=DedupeResponseHeader=Access-Control-Allow-Origin Access-Control-Allow-Credentials,RETAIN_UNIQUE

# Global CORS configuration
spring.cloud.gateway.server.webflux.globalcors.corsConfigurations[/**].allowedOrigins=http://localhost:3000,http://localhost:5173
spring.cloud.gateway.server.webflux.globalcors.corsConfigurations[/**].allowedMethods=GET,HEAD,POST,PUT,DELETE,OPTIONS,PATCH
spring.cloud.gateway.server.webflux.globalcors.corsConfigurations[/**].allowedHeaders=*
spring.cloud.gateway.server.webflux.globalcors.corsConfigurations[/**].allowCredentials=true
